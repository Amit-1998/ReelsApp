(this.webpackJsonpreels=this.webpackJsonpreels||[]).push([[0],{29:function(e){e.exports=JSON.parse('{"apiKey":"AIzaSyCFBP6xmIaXmEtM99GDzMDfNyHRSz4dGVo","authDomain":"reelsapp-db4b8.firebaseapp.com","projectId":"reelsapp-db4b8","storageBucket":"reelsapp-db4b8.appspot.com","messagingSenderId":"238694073916","appId":"1:238694073916:web:23b8499b8043414934a539"}')},41:function(e,t,c){},42:function(e,t,c){},47:function(e,t,c){},48:function(e,t,c){},49:function(e,t,c){"use strict";c.r(t);var n=c(2),a=c(28),s=c.n(a),o=c(21),r=c(5),i=c(9),l=c.n(i),u=c(15),d=c(31),j=c(13),b=c(18),p=c(29);c(37),c(51),c(50);b.a.initializeApp(p);var m=new b.a.auth.GoogleAuthProvider,h=b.a.auth(),f=b.a.firestore(),O=b.a.storage(),x=(b.a,c(1)),v=Object(n.createContext)(),g=function(e){var t=Object(n.useState)(null),c=Object(j.a)(t,2),a=c[0],s=c[1],o=Object(n.useState)(!0),r=Object(j.a)(o,2),i=r[0],d=r[1];return Object(n.useEffect)((function(){var e=h.onAuthStateChanged(function(){var e=Object(u.a)(l.a.mark((function e(t){var c,n,a,o,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return c=t.displayName,n=t.email,a=t.uid,o=t.photoURL,r=f.collection("users").doc(a),e.next=5,r.get();case 5:e.sent.exists||r.set({displayName:c,email:n,photoURL:o,posts:[]}),s({displayName:c,email:n,uid:a,photoURL:o,posts:[]}),e.next=11;break;case 10:s(null);case 11:d(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return function(){e()}}),[]),Object(x.jsx)(v.Provider,{value:a,children:!i&&e.children})},k=(c(41),c(42),function(e){var t,c=Object(n.useState)(!1),a=Object(j.a)(c,2),s=a[0],o=a[1],r=Object(n.useState)(!1),i=Object(j.a)(r,2),d=i[0],b=i[1],p=Object(n.useState)(""),m=Object(j.a)(p,2),h=m[0],O=m[1],g=Object(n.useState)([]),k=Object(j.a)(g,2),N=k[0],y=k[1],C=Object(n.useContext)(v);return C&&(t=e.data.likes.includes(C.uid)),Object(n.useEffect)((function(){(function(){var t=Object(u.a)(l.a.mark((function t(){var c,n,a,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c=e.data.comments,n=[],a=0;case 3:if(!(a<c.length)){t.next=11;break}return t.next=6,f.collection("comments").doc(c[a]).get();case 6:s=t.sent,n.push(s.data());case 8:a++,t.next=3;break;case 11:y(n);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),Object(x.jsxs)("div",{className:"video-card",children:[Object(x.jsx)("p",{className:"video-card-username",children:e.data.name}),Object(x.jsxs)("span",{className:"video-card-music",children:[Object(x.jsx)("span",{class:"material-icons",children:" music_note"}),Object(x.jsx)("marquee",{children:"some song"})]}),Object(x.jsx)("span",{onClick:function(e){b(!d)},class:"material-icons-outlined video-card-comment",children:"chat"}),Object(x.jsx)("span",{class:"material-icons-outlined video-card-like",onClick:function(){var c=e.data.likes;t?c=c.filter((function(e){return e!=C.uid})):c.push(C.uid),f.collection("posts").doc(e.data.id).update({likes:c})},children:t?"favorite":"favorite_border"}),d?Object(x.jsxs)("div",{className:"video-card-comment-box",children:[Object(x.jsx)("div",{className:"actual-comments",children:N.map((function(e){return Object(x.jsxs)("div",{className:"post-user-comment",children:[Object(x.jsx)("img",{src:e.photo}),Object(x.jsxs)("div",{children:[Object(x.jsx)("h5",{children:e.name}),Object(x.jsx)("p",{children:e.comment})]})]})}))}),Object(x.jsxs)("div",{className:"comment-form",children:[Object(x.jsx)("input",{type:"text",value:h,onChange:function(e){O(e.currentTarget.value)}}),Object(x.jsx)("button",{onClick:Object(u.a)(l.a.mark((function t(){var c,n,a,s,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.collection("comments").add({name:C.displayName,comment:h,photo:C.photoURL});case 2:return c=t.sent,O(""),t.next=6,c.get();case 6:return n=t.sent,a=n.id,t.next=10,f.collection("posts").doc(e.data.id).get();case 10:return s=t.sent,(o=s.data().comments).push(a),t.next=15,f.collection("posts").doc(e.data.id).update({comments:o});case 15:case"end":return t.stop()}}),t)}))),children:"Post"})]})]}):"",Object(x.jsx)("video",{onClick:function(e){s?(e.currentTarget.pause(),o(!1)):(e.currentTarget.play(),o(!0))},loop:!0,src:e.data.url,className:"video-card-video"})]})}),N=function(){var e=Object(n.useContext)(v),t=Object(n.useState)([]),c=Object(j.a)(t,2),a=c[0],s=c[1],o=Object(r.g)();return Object(n.useEffect)((function(){var t=f.collection("posts").onSnapshot((function(t){for(var c=t.docs,n=[],a=[],o=0;o<c.length;o++)n.push(Object(d.a)({id:c[o].id},c[o].data())),a.push(c[o].id);f.collection("users").doc(e.uid).update({posts:a}),s(n)}));return function(){t()}}),[]),Object(x.jsxs)(x.Fragment,{children:[e?"":Object(x.jsx)(r.a,{to:"./login"}),Object(x.jsxs)("div",{className:"video-container",children:[Object(x.jsxs)("div",{className:"Profile-navbar",children:[Object(x.jsx)("div",{onClick:function(){o.push("/profile")},className:"profile-icon",children:"Profile"}),Object(x.jsx)("p",{children:"My Posts"})]}),Object(x.jsx)("div",{className:"video-Element",children:a.map((function(e){return Object(x.jsx)(k,{data:e},e.id)}))})]}),Object(x.jsx)("button",{className:"home-logout-btn",onClick:function(){h.signOut()},children:"Logout"}),Object(x.jsx)("input",{type:"file",onClick:function(e){e.currentTarget.value=null},onChange:function(t){var c=t.currentTarget.files[0],n=c.name,a=c.size,s=c.type;if((a/=1e6)>40)alert("File Size exceeds 40mb");else if("video"===(s=s.split("/")[0])){var o=O.ref("posts/".concat(e.uid,"/").concat(Date.now()+"-"+n)).put(c);o.on("state_changed",null,null,Object(u.a)(l.a.mark((function t(){var c,n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.snapshot.ref.getDownloadURL();case 2:return c=t.sent,t.next=5,f.collection("posts").add({name:e.displayName,likes:[],comments:[],url:c});case 5:return n=t.sent,n.id,t.next=9,f.collection("users").doc(e.uid).get();case 9:a=t.sent,console.log(a),console.log(a.data());case 12:case"end":return t.stop()}}),t)}))))}else alert("Please upload a video file")}})]})},y=(c(47),function(){var e=Object(n.useContext)(v);return console.log(e),Object(x.jsxs)(x.Fragment,{children:[e?Object(x.jsx)(r.a,{to:"/"}):"",Object(x.jsx)("button",{onClick:function(){h.signInWithPopup(m)},class:"btn btn-primary m-4",children:"Login with Google"})]})}),C=(c(48),function(){var e=Object(n.useContext)(v);console.log(e);var t=Object(r.g)(),c=Object(n.useState)([]),a=Object(j.a)(c,2),s=a[0],o=a[1];return Object(n.useEffect)((function(){Object(u.a)(l.a.mark((function t(){var c,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.collection("users").doc(e.uid).get();case 2:c=t.sent,n=c.data().posts,o(n);case 5:case"end":return t.stop()}}),t)})))()}),[]),Object(x.jsxs)("div",{className:"displayInfo",children:[Object(x.jsxs)("div",{className:"Info",children:[Object(x.jsx)("h1",{children:e.displayName}),Object(x.jsx)("p",{children:Object(x.jsxs)("h5",{children:["No of Posts : ",s.length]})})]}),Object(x.jsx)("button",{onClick:function(){t.push("/")},className:"GoBack",children:"Back"})]})}),w=function(){return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(g,{children:Object(x.jsx)(o.a,{children:Object(x.jsxs)(r.d,{children:[Object(x.jsx)(r.b,{exact:!0,path:"/profile",children:Object(x.jsx)(C,{})}),Object(x.jsx)(r.b,{exact:!0,path:"/login",children:Object(x.jsx)(y,{})}),Object(x.jsx)(r.b,{exact:!0,path:"/",children:Object(x.jsx)(N,{})})]})})})})};s.a.render(Object(x.jsx)(w,{}),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.16da8211.chunk.js.map